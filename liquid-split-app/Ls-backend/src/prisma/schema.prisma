// Prisma schema for LiquidSplit
// Real-time fractional ownership of purchases

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =====================
// üë§ User Model
// =====================
model User {
  id        Int         @id @default(autoincrement())
  name      String
  email     String      @unique
  password  String      // bcrypt hashed password
  balance   Float       @default(0)
  stripeAccountId String? @unique
  pots      PotMember[] // pots user participates in
  createdAt DateTime    @default(now())
}

// =====================
// üíß Pot Model
// =====================
model Pot {
  id          Int         @id @default(autoincrement())
  name        String
  totalAmount Float       @default(0)
  members     PotMember[] // relation through join table
  createdAt   DateTime    @default(now())
}

// =====================
// ü§ù PotMember (Join Table)
// =====================
model PotMember {
  id        Int     @id @default(autoincrement())
  userId    Int
  potId     Int
  share     Float   @default(0)

  // Relations
  user User @relation(fields: [userId], references: [id])
  pot  Pot  @relation(fields: [potId], references: [id])

  @@unique([userId, potId]) // prevents duplicate entries
}